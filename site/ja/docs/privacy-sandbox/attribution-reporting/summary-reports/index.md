---
layout: 'layouts/doc-post.njk'
title: 'アトリビューション レポート: 要約レポート'
subhead: >
  個々のデータを明らかにすることなく、ユーザー全体で集計された広告コンバージョンを測定します。 以前は集計レポートと呼ばれていました。
description: >
  個々のデータを明らかにすることなく、ユーザー全体で集計された広告コンバージョンを測定します。 以前は集計レポートと呼ばれていました。
date: 2022-02-16
updated: 2022-06-06
authors:
  - alexandrawhite
---

## 実装状況

*  最初の提案（[クライアントサイド](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATE.md)、[サーバーサイド](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATION_SERVICE_TEE.md)）および初期のディスカッション段階
*  [Attribution Reporting API 仕様](https://wicg.github.io/conversion-measurement-api/)

*  [Chrome プラットフォームのステータス](https://chromestatus.com/feature/5762222527610880)
*  この API は [広告効果と測定オリジントライアルで利用できます](/blog/privacy-sandbox-unified-origin-trial/)。
*  [アトリビューション レポート: テストとディスカッション](/docs/privacy-sandbox/attribution-reporting-experiment/)。
*  [API の変更点](/docs/privacy-sandbox/attribution-reporting-updates/) を追跡する。

## アトリビューション レポートの要約レポートとは？

Attribution Reporting API を使用すると、広告のクリックまたはビューが、販売やサインアップなどの広告主サイトでのコンバージョンにつながるタイミングを測定できます。 この API は、サイト全体で個々のユーザーを識別するために使用できるサードパーティ Cookie や仕組みには依存しません。

この API には 2 種類のレポートがあります。 [イベントレベルのレポート](/docs/privacy-sandbox/attribution-reporting/#event-level-reports)は Chrome ですでにテスト可能で、特定の広告クリックまたはビューを詳細度の低いコンバージョンデータに関連付けます。 ブラウザは、サイト間での ID 接続を防ぐために、アドテク企業へのレポートの送信を数日間遅らせます。

_要約レポート_（以前は集計レポートと呼ばれていました）は、どの個人にも関連付けられないように、ユーザーをグループとしてコンパイルします。 要約レポートには、購入金額やカートの内容などの詳細なコンバージョンデータが含まれ、データを自由にクリックしたり表示したりすることができます。 これらのレポートの送信は、イベントレベルのレポートほどに遅延されることはありません。

まだ読んでいないのであれば、この記事の以降の内容を読む前に、[アトリビューション レポートの全般的な概要](/docs/privacy-sandbox/attribution-reporting-introduction/)を読むことをお勧めします。

## 要約レポートが必要な理由

{% Img class="float-right", src="image/VbsHyyQopiec0718rMq2kTE1hke2/mvk4I92OFInhVvwZEbiu.jpg", alt="ブラウザで同じアクション（靴の購入など）を実行するユーザーの集合体には、同じコンバージョンが集計される可能性がある。", width="305", height="220" %}

今日では、広告コンバージョンの測定の多くが[サードパーティ Cookie](https://developer.mozilla.org/docs/Web/HTTP/Cookies#Third-party_cookies) に依存しています。 一方ブラウザは、サードパーティ Cookie へのアクセスを制限することで、サイト間でのユーザーの追跡をより困難にし、ユーザーのプライバシーを向上させています。 Attribution Reporting API を使用すれば、アドテクはサードパーティ Cookie を使用しなくても、プライバシーを保護しながらコンバージョンを測定できるようになります。

単一のイベント（クリックやビューなど）を[粗粒データ](/docs/privacy-sandbox/glossary/#coarse-data)に関連付ける Attribution Reporting API のイベントレベルレポートとは対照的に、要約レポートは、詳細なコンバージョンデータ（ユーザーが購入した具体的な商品など）に紐づけられた集計データ（コンバージョンされたユーザー数など）を提供します。 

{% Aside 'key-term' %}
アドテクは、ブラウザのイベントを処理する[集計サービス](#aggregation-service)を実行します。 イベントにレポートされるほとんどのデータポイントには[ノイズは](https://en.wikipedia.org/wiki/Additive_noise_mechanisms)が追加されるため、要約レポートで個別のデータが検出されることはありません。

_集計データ_ は、コンバージョンされたユーザー数など、コンバージョンの測定に関連する、ノイズが付加された値です。
{% endAside %}

サードパーティ Cookie とは異なり、Attribution Reporting API のレポートタイプでは、エンティティ（アドテク、バイヤー、サイト運営者など）が複数のサイトにまたがるユーザーのブラウジング行動を「確認」できないようにしながらも、広告のコンバージョンを測定することが可能です。

## ユーザーデータの収集と集計方法

{% Partial 'privacy-sandbox/feedback-aside.njk' %}

Attribution Reporting API を使用すると、サイト間の個々のユーザーの詳細なアクティビティや、場合によってはユーザーの ID が、ユーザーのデバイス上のブラウザーに非公開で維持されます。 このデータは集計可能なレポートで収集でき、各レポートはさまざまなパーティが基盤データにアクセスできないように暗号化されます。

{% Aside 'key-term' %}
_集計可能なレポート_ は、個々のユーザーのブラウザから収集されたレポートです。 これらは、 アドテクプロバイダーが定義するクロスサイトのユーザー行動と[コンバージョン](/docs/privacy-sandbox/glossary/#conversion)について詳しく説明しています。
{% endAside %}

要約レポートを作成するためのプロセスは、以下のように提案されています。

1. 集計可能なレポートが、アドテクプロバイダーが運営する _レポートオリジン_ に送信されます。
   *  これらのレポートには、位置情報、クリック数、コンバージョンの値（購入価格など）、アドテクプロバイダーが定義するその他の指標などが含まれる場合があります。 レポートは暗号化されているため、アドテクプロバイダーは、個々のレポートのコンテンツの表示やそれにアクセスすることはできません。
1. アドテクレポートオリジンが集計可能なレポートを受信すると、アドテクはそのレポートを[_集計サービス_](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATION_SERVICE_TEE.md)に送信します。
   *  最初の実装では、[集計 サービス](#aggregation-service)は、クラウドでホストされている信頼できる実行環境（TEE）を備えたアドテクプロバイダー によって運用されています。 _コーディネーター_ は、確認済みのエンティティのみが復号化キーにアクセスし、他の仲介者（アドテク、クラウドプロバイダー、またはその他のパーティ）は集計プロセスの外部で機密データにアクセスして復号化できないように保証します。
1. 集計サービスは、復号化されたデータを結合し、 _要約レポート_ をアドテクプロバイダーに出力します。
   *  要約レポートには、結合されたデータの要約が含まれます。 アドテクプロバイダーは、要約レポートを読み取って使用できます。

<figure>
{% Img
   class="screehshot",
   src="image/VbsHyyQopiec0718rMq2kTE1hke2/hoRtQVV2b2MCXIKi1okK.jpg",
   alt="要約レポートの作成プロセスでは、暗号化済みのレポートがコレクターサーバーに送信されるように提案されています。 コレクターサーバーは、データを安全な集約サービスに送信します。この集約サービスでは、キーを使用してデータを復号化して要約レポートが作成されます。 その上で、レポートがアドテクプロバイダーに返送されます。",
   width="800", height="168"
%}
  <figcaption>
    完全なシーケンス図については、<a href="/docs/privacy-sandbox/attribution-reporting-introduction/#aggregate-reports">アトリビューション レポートの紹介</a>をご覧ください。
  </figcaption>
</figure>

各レポートにはサイト間のユーザー行動情報が含まれる場合があるため、集計サービスはこの情報を非公開として扱う必要があります。 このサービスは、他のエンティティが暗号化されていない個々のアトリビューションレポートにアクセスできないようにします。 さらに、サービス自体がプライバシーを侵害するアクションを実行しないことが必要です。

集計サービスが実際に安全であることを保証するために、サービスには、消費者監査によって検証可能な技術的および組織的な保護手段が必要がです。 これらの保護手段は、以下に対して有益です。

*  個別のユーザー。ユーザーはそれぞれのデータが集計でのみアクセスされ、任意のエンティティによってアクセスされることがないことを確信できます。
*  アドテク。集計プロセスが有効なデータを使用していることを検証し、適切に監視することができます。


### 集計サービスでレポートを生成する {: #aggregation-service}

{% Aside 'key-term' %}
_信頼できる実行環境_（TEE）は、外部パーティがコンピューターで実行されているソフトウェアの正確なバージョンを確認できるようにする、コンピューターのハードウェアとソフトウェアの特別な構成です。 TEE を使用すると、外部パーティは、ソフトウェアがソフトウェアメーカーが主張していることを過不足なく正確に実行していることを確認できます。
{% endAside %}

[最初の提案](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATION_SERVICE_TEE.md)では、各アドテクプロバイダーに、必要なセキュリティ機能をサポートするクラウドサービスにデプロイされた信頼できる実行環境（TEE）で独自の集計サービスのインスタンスを動作することが求められています。

{% Aside %}
みなさんは、ローカルテストおよび Amazon Web Services が提供する信頼できる実行環境（TEE）がサポートされる集計サービスを含むアトリビューション レポートの[オリジントライアルに参加することができます](/docs/privacy-sandbox/attribution-reporting-experiment/)。[集計サービスのセットアップ方法](https://github.com/google/trusted-execution-aggregation-service/#set-up-aggregation-service-for-aggregatable-reports)をご覧ください.

将来的に、集計サービスのセキュリティ要件に見合った他のクラウドプロバイダーも追加する予定です。
{% endAside %}

TEE のコードは、集計サービスで生のレポートにアクセスできる唯一の場所です。このコードは、セキュリティ研究者、プライバシーアドボケート、およびアドテクによって監査可能になります。 TEE が承認済みの実際のソフトウェアを実行しており、データが保護されていることを確認するために、コーディネーターはアテステーションを実行します。

コーディネーターには以下のような責任があります。

*  承認されたバイナリイメージのリストを管理する。 これらのイメージは、Google が定期的にリリースする、集計サービスソフトウェアビルドの[暗号化ハッシュ](https://en.wikipedia.org/wiki/Cryptographic_hash_function)です。 これは再現可能であるため、どのパーティもイメージが集計サービスのビルドと同一であることを確認できます。
*  キー管理システムを運用する。 集計可能なレポートを暗号化するには、ユーザーのデバイスに Chrome の暗号化キーが必要です。 集計サービスコードがバイナリイメージと一致することを証明するためには、復号化キーが必要です。
*  集計可能なレポートを追跡して、要約レポートの集計で再利用されないようにする。再利用によって個人を特定できる情報（PII）が明らかになる可能性があるためです。

オリジントライアルで集計サービスのテストを可能にするために、Google がコーディネーターの役割を果たします。 より長期的には、この役割を共有できる独立したエンティティを 1 つ以上特定するよう取り組んでいます。

### 取り込まれる情報

要約レポートは、詳細な広告側データとコンバージョンデータとともに集計データを提供します。

たとえば、アドテクプロバイダーが `news.example` で広告キャンペーンを実行した場合、コンバージョンは、ユーザーが靴の広告をクリックし、`shoes.example` で靴の購入を完了したことを表します。 アドテクは、ID `1234567` のこの広告キャンペーンの要約レポートを受け取ります。このレポートには、**2022 年 1 月 12 日**に shoes.example で **518** のコンバージョンがあり、合計費用が **$38,174** であることが記載されています。 コンバージョンの **60％** は、ユーザーが購入したプロダクト SKU `9872` の青いスニーカーで、**40%** は、プロダクト SKU `2643` の黄色いサンダルが占めています。 キャンペーン ID は詳細な広告側データで、プロダクト SKU は詳細なコンバージョンデータです。 集計データは、コンバージョン数と合計費用となります。

コンバージョンは広告主またはアドテク企業が定義するものであり、広告キャンペーンごとに異なる場合があります。 あるキャンペーンでは、広告されたアイテムのユーザー購入が続く広告クリック数を測定し、 別のキャンペーンでは、広告主のサイトへのアクセスにつながった広告ビューの数を測定できます。

### 集計前のブラウザデータの取り込み

要約レポートは個人のグループから得られるデータで構成されているため、1 人のユーザーのブラウザアクションから始めましょう。

1. ユーザーがサイト運営者のサイトにアクセスし、広告を表示またはクリックします（アトリビューションソースイベントと呼ばれます）。
1. 数分後または数日後に、そのユーザーがコンバージョンします（アトリビューショントリガーイベントと呼ばれます）。 たとえば、コンバージョンは商品の購入として定義できます。
{% Img class="screehshot", src="image/VbsHyyQopiec0718rMq2kTE1hke2/oHfdWrzpCl2uAYcXQfU8.jpg", alt="", width="700", height="209" %}
1. ブラウザソフトウェアが、広告のクリックまたはビューをコンバージョンイベントと一致させます。 この一致に基づいて、ブラウザは、アドテクプロバイダーが作成した特定のロジックを使って集計可能なレポートを作成します。
1. ブラウザはこのデータを暗号化し、少し遅れてから、収集を行うアドテクサーバーに送信します。 アドテクサーバーがこれらの集計可能なレポートから集計されたインサイトにアクセスには、集計サービスに依存する必要があります。
{% Img class="screehshot", src="image/VbsHyyQopiec0718rMq2kTE1hke2/gGKktJZoaKXTX4YG9udv.jpg", alt="", width="564", height="209" %}

## 要約レポートを作成する

アドテクプロバイダーが要約レポートを取得するには、以下の手順を実行する必要があります。

1. アドテクは、個々のユーザーのブラウザから集計可能なレポートを収集します。
   {% Aside %}
   アドテクは、集計サービスでのみこれらのレポートを復号化できます。複合されたデータは信頼できる実行環境（TEE）外では利用できません。
   {% endAside %}
1. アドテクプロバイダーは、集計可能なレポートをバッチ処理し、そのバッチを集計サービスに送信します。
1. 集計サービスは、データを集計するようにワーカーをスケジュールします。
   {% Aside %}
   ワーカーが集計する前に、コーディネーターによるアテステーションが必要です。 ワーカーがアテステーションに合格すると、復号化キーが提供されます。
   {% endAside %}
1. 集計ワーカーは、ノイズデータ（データのプライバシー保護手段）とともに、集計可能なレポートのデータを復号化して集計します。
1. 集計サービスが、要約レポートをアドテクプロバイダーに返します。

アドテクは要約レポートを使用して入札の通知と自社顧客へのレポート提供を行えます。 [JSON エンコードされたスキーム](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATE.md#aggregate-attribution-reports)は、要約レポート用に提案されている形式です。

{% Partial 'privacy-sandbox/ar-engage.njk' %}

## 詳細について

*  [アトリビューション レポート (Conversion Measurement) の概要](/docs/privacy-sandbox/attribution-reporting-introduction/) をお読みください。
*  [集計サービスの Explainer](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATION_SERVICE_TEE.md) および [詳細なセットアップ方法](https://github.com/google/trusted-execution-aggregation-service/)をお読みください。
*  [プライバシーサンドボックスを掘り下げる](https://web.dev/digging-into-the-privacy-sandbox)
