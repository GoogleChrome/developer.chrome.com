---
layout: 'layouts/blog-post.njk'
title: Generate summary reports with the aggregation service
authors:
  - alexandrawhite
description: >
  Experiment and set up the aggregation service to generate Attribution Reporting summary reports.
date: 2022-06-06
hero: image/VbsHyyQopiec0718rMq2kTE1hke2/ASAZM31nd8FvgV22LTvJ.jpg
alt: Cords plugged into the server, which represents service set up.
tags:
  - privacy
  - experiment
---

You can now [experiment and participate in an origin
trial](/docs/privacy-sandbox/attribution-reporting-experiment/) for Attribution
Reporting. There are a number of available developer resources and code samples
to get started.

To generate summary reports in the origin trial, you'll first need to set up
the aggregation service. This blog post gives an overview of those steps.

{% Aside %}
If you ran an origin trial with this API in 2021, follow the [migration
guide](https://docs.google.com/document/d/1NY7SScCYcPc9v5wtf_fVAikFxGQTAFvwldhExN1P03Y/edit?usp=sharing)
to prepare for the latest origin trial.
{% endAside %}

## Key terms

If you haven't already, we recommend you read the [overview of Attribution
Reporting](/docs/privacy-sandbox/attribution-reporting-introduction/) and more
about [summary reports](/docs/privacy-sandbox/attribution-reporting/summary-reports/)
before learning about the aggregation service set up.

*  A _summary report_ is a compiled output for the Attribution Reporting API,
   which aggregates information about a group of users. Summary reports offer
   detailed conversion data, such as purchase value and cart contents, with flexibility for click and view data.
*  An _aggregatable report_ is an encrypted report, generated by an individual
   user's browser. These contain data about individual conversions and
   associated metrics, as defined by the advertiser or adtech. Learn more about
   [aggregatable reports](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATE.md).
*  The _aggregation service_ processes data from aggregatable reports to
   create a summary report.

## Set up the aggregation service

The [aggregation service
proposal](https://github.com/WICG/conversion-measurement-api/blob/main/AGGREGATION_SERVICE_TEE.md)
asks each adtech provider to operate their own instance of the aggregation
service in a trusted execution environment (TEE) deployed on a cloud service
that supports needed security features.

For the initial implementation and origin trial, adtechs can set up
[local testing](https://github.com/google/trusted-execution-aggregation-service/#set-up-local-testing)
or [test in TEEs with Amazon Web Services](https://github.com/google/trusted-execution-aggregation-service/#test-on-aws-with-support-for-encrypted-reports) (AWS):

1. [Register](/origintrials/#/view_trial/771241436187197441) for the Privacy Sandbox Relevance and Measurement origin trial (OT).
1. Create or have an [Amazon Web Services account](https://portal.aws.amazon.com/gp/aws/developer/registration/index.html).
1. Complete the aggregation service
   [onboarding form](https://forms.gle/EHoecersGKhpcLPNA). After filling out
   this form we will send a verification email and instructions for how to set
   up the aggregation service.

Both the local testing tool and the aggregation service running on AWS expect
aggregatable reports to be batched in the
[Apache Avro](https://avro.apache.org/) format.
[Review code snippets](https://github.com/google/trusted-execution-aggregation-service/blob/main/COLLECTING.md)
which demonstrate how to collect and batch aggregatable reports.

## Generate summary reports with TEEs on AWS

{% Aside %}
This is a general overview of how to generate summary reports in TEEs. Read the
detailed developer documentation on [testing the aggregation service with
AWS](https://github.com/google/trusted-execution-aggregation-service/#test-on-aws-with-support-for-encrypted-reports).
{% endAside %}

To generate summary reports, you'll need to set up the aggregation service in
AWS with [Terraform](https://www.terraform.io/). Terraform will help provision,
manage, and decommission the aggregation service on AWS
[Nitro Enclave instances](https://aws.amazon.com/ec2/nitro/nitro-enclaves/).

1. [Install](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)
   and [set up](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html)
   the latest AWS client.
2. [Set up Terraform](https://github.com/google/trusted-execution-aggregation-service/#set-up-terraform).
3. Download the [aggregation service
   dependencies](https://github.com/google/trusted-execution-aggregation-service/#download-dependencies).
4. Set up a [deployment
   environment](https://github.com/google/trusted-execution-aggregation-service/#set-up-your-deployment-environment).
5. [Test your
   system](https://github.com/google/trusted-execution-aggregation-service/#testing-the-system).

## Get support

For more support with the Attribution Reporting API:

*  Open a new Issue on the [Privacy Sandbox Developer Support GitHub
   repository](https://github.com/GoogleChromeLabs/privacy-sandbox-dev-support/issues/new/choose).
   Select the Issue template for Attribution Reporting.
*  Or [join the Attribution Reporting mailing list for
   developers](https://groups.google.com/u/1/a/chromium.org/g/attribution-reporting-api-dev)
   and ask there.

If you notice any unexpected behavior:

*  [View Chrome
   issues](https://bugs.chromium.org/p/chromium/issues/list?q=component%3AInternals%3EConversionMeasurement) reported for the API implementation.
*  Open a [Chrome bug](https://crbug.com/new).
*  Raise a new Issue for the [Trusted Execution Aggregation
   Service](https://github.com/google/trusted-execution-aggregation-service/issues).
